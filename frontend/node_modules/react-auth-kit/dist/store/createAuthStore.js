"use strict";
'use client';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createAuthStore;
var _TokenStore = _interopRequireDefault(require("./TokenStore"));
var _error = require("../error");
var _CookieStorage = _interopRequireDefault(require("../storage/CookieStorage"));
var _LocalStorage = _interopRequireDefault(require("../storage/LocalStorage"));
var _DefaultStorageNamingStrategy = _interopRequireDefault(require("../storage/DefaultStorageNamingStrategy"));
var _JwtToken = _interopRequireDefault(require("../token/JwtToken"));
var _valueOrDefault = _interopRequireDefault(require("../utils/valueOrDefault"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function createAuthStore(authType, authAttributes) {
  var storage;
  if (authType === "cookie") {
    var cookieSecure = (0, _valueOrDefault.default)(authAttributes.cookieSecure, window.location.protocol === 'https:');
    var cookieDomain = (0, _valueOrDefault.default)(authAttributes.cookieDomain, window.location.hostname);
    var cookiePath = (0, _valueOrDefault.default)(authAttributes.cookiePath, '/');
    var cookieSameSite = (0, _valueOrDefault.default)(authAttributes.cookieSameSite, 'none');
    storage = new _CookieStorage.default(cookieDomain, cookieSecure, cookiePath, cookieSameSite);
  } else if (authType === "localstorage") {
    storage = new _LocalStorage.default();
  } else {
    throw new _error.AuthKitConfigError("authType '".concat(authType, "' is not supported. Use 'cookie' or 'localstorage'"));
  }
  var tokenStore = new _TokenStore.default(!!authAttributes.refresh, storage, new _DefaultStorageNamingStrategy.default((0, _valueOrDefault.default)(authAttributes.authName, '_auth')), new _JwtToken.default(), (0, _valueOrDefault.default)(authAttributes.debug, false));
  return {
    tokenStore: tokenStore,
    refresh: authAttributes.refresh
  };
}